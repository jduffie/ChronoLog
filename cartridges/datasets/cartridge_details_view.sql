 SELECT f.id AS spec_id,
    'factory'::text AS source,
    f.cartridge_type,
    f.make AS manufacturer,
    f.model,
    f.bullet_id,
    concat_ws(' '::text, COALESCE(NULLIF(TRIM(BOTH FROM concat_ws(' '::text, b.manufacturer, b.model)), ''::text), 'Unknown'::text), concat_ws(' '::text, b.weight_grains::text, 'gr'), concat_ws(' '::text, round(b.bore_diameter_land_mm::numeric, 3)::text, 'mm')) AS bullet_name,
    b.manufacturer AS bullet_manufacturer,
    b.model AS bullet_model,
    b.weight_grains AS bullet_weight_grains,
    b.bullet_diameter_groove_mm,
    b.bore_diameter_land_mm,
    b.bullet_length_mm,
    b.ballistic_coefficient_g1,
    b.ballistic_coefficient_g7,
    b.sectional_density,
    b.min_req_twist_rate_in_per_rev,
    b.pref_twist_rate_in_per_rev
   FROM factory_cartridge_specs f
     LEFT JOIN bullets b ON b.id = f.bullet_id
UNION ALL
 SELECT c.id AS spec_id,
    'custom'::text AS source,
    c.cartridge_type,
    NULL::text AS manufacturer,
    c.name AS model,
    c.bullet_id,
    concat_ws(' '::text, COALESCE(NULLIF(TRIM(BOTH FROM concat_ws(' '::text, b.manufacturer, b.model)), ''::text), 'Unknown'::text), concat_ws(' '::text, b.weight_grains::text, 'gr'), concat_ws(' '::text, round(b.bore_diameter_land_mm::numeric, 3)::text, 'mm')) AS bullet_name,
    b.manufacturer AS bullet_manufacturer,
    b.model AS bullet_model,
    b.weight_grains AS bullet_weight_grains,
    b.bullet_diameter_groove_mm,
    b.bore_diameter_land_mm,
    b.bullet_length_mm,
    b.ballistic_coefficient_g1,
    b.ballistic_coefficient_g7,
    b.sectional_density,
    b.min_req_twist_rate_in_per_rev,
    b.pref_twist_rate_in_per_rev
   FROM custom_cartridge_specs c
     LEFT JOIN bullets b ON b.id = c.bullet_id;